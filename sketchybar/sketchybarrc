# SketchyBar config file.

PLUGIN_DIR="$CONFIG_DIR/plugins"

# Source pywal colors
eval "$("$CONFIG_DIR/colors.py")"

# Bar Appearance

sketchybar --bar position=top height=34 blur_radius=0 color=0x00000000 \
                 corner_radius=0 \
                 border_width=0 \
                 margin=0 \
                 y_offset=5 \
                 padding_left=10 \
                 padding_right=10

default=(
  padding_left=5
  padding_right=5
  icon.font="Hack Nerd Font:Bold:17.0"
  label.font="Hack Nerd Font:Bold:14.0"
  icon.color="$ICON_COLOR"
  label.color="$LABEL_COLOR"
  icon.padding_left=4
  icon.padding_right=4
  label.padding_left=4
  label.padding_right=4
)
sketchybar --default "${default[@]}"

SPACE_ICONS=("1" "2" "3" "4" "5" "6" "7" "8" "9" "10")
SPACE_IDS=()
for i in "${!SPACE_ICONS[@]}"
do
  sid="$(($i+1))"
  SPACE_IDS+=("space.$sid")

  # Set different padding for first and last workspace
  if [ "$sid" = "1" ]; then
    # First workspace - more left padding
    space=(
      space="$sid"
      icon="${SPACE_ICONS[i]}"
      icon.padding_left=8
      icon.padding_right=2
      background.color=0x00000000
      background.corner_radius=0
      background.height=25
      label.drawing=off
      script="$PLUGIN_DIR/space.py"
      click_script="yabai -m space --focus $sid"
    )
  elif [ "$sid" = "5" ]; then
    # Last workspace - more right padding
    space=(
      space="$sid"
      icon="${SPACE_ICONS[i]}"
      icon.padding_left=2
      icon.padding_right=8
      background.color=0x00000000
      background.corner_radius=0
      background.height=25
      label.drawing=off
      script="$PLUGIN_DIR/space.py"
      click_script="yabai -m space --focus $sid"
    )
  else
    # Middle workspaces - normal padding
    space=(
      space="$sid"
      icon="${SPACE_ICONS[i]}"
      icon.padding_left=2
      icon.padding_right=2
      background.color=0x00000000
      background.corner_radius=0
      background.height=25
      label.drawing=off
      script="$PLUGIN_DIR/space.py"
      click_script="yabai -m space --focus $sid"
    )
  fi

  sketchybar --add space space."$sid" left --set space."$sid" "${space[@]}"
done

sketchybar --add bracket spaces_bracket "${SPACE_IDS[@]}" \
           --set spaces_bracket background.color="$ITEM_BG_COLOR" \
                                background.corner_radius=16 \
                                background.height=28 \
                                background.border_width=0

# Left Part

# sketchybar --add item spacer left \
#            --set spacer width=10 \
#            \
#            --add item front_app left \
#            --set front_app icon=">" script="$PLUGIN_DIR/front_app.sh" \
#            --subscribe front_app front_app_switched \
#            \
#            --add bracket front_app_bracket front_app \
#            --set front_app_bracket background.color="$ITEM_BG_COLOR" \
#                                    background.corner_radius=16 \
#                                    background.height=28 \
#                                    background.border_width=0

# Right Part

sketchybar --add item clock right \
           --set clock update_freq=10 icon="" padding_left=-5 padding_right=10 script="$PLUGIN_DIR/clock.py" \
           --add item volume right \
           --set volume script="$PLUGIN_DIR/volume.py" \
           --subscribe volume volume_change \
           --add item wifi right \
           --set wifi update_freq=5 script="$PLUGIN_DIR/wifi.py" padding_right=-15 \
           --subscribe wifi wifi_change \
           --add item bluetooth right \
           --set bluetooth update_freq=5 script="$PLUGIN_DIR/bluetooth.py" \
                           padding_left=1 padding_right=1 \
                           icon.padding_left=0 icon.padding_right=0 \
                           label.padding_left=0 label.padding_right=0 \
           --add item battery right \
           --set battery update_freq=120 script="$PLUGIN_DIR/battery.py" \
                           icon.padding_left=8 padding_right=5 \
           --subscribe battery system_woke power_source_change \
           \
           --add bracket right_bracket clock volume wifi bluetooth battery \
           --set right_bracket background.color="$ITEM_BG_COLOR" \
                               background.corner_radius=16 \
                               background.height=28 \
                               background.border_width=0

sketchybar --update
